!function(t,e,n){"undefined"!=typeof module&&module.exports?module.exports=n():"function"==typeof define&&define.amd?define(n):e[t]=n()}("reqwest",this,function(){function handleReadyState(t,e,n){return function(){return t._aborted?n(t.request):(t.request&&4==t.request[readyState]&&(t.request.onreadystatechange=noop,twoHundo.test(t.request.status)?e(t.request):n(t.request)),void 0)}}function setHeaders(t,e){var n,r=e.headers||{};r.Accept=r.Accept||defaultHeaders.accept[e.type]||defaultHeaders.accept["*"],e.crossOrigin||r[requestedWith]||(r[requestedWith]=defaultHeaders.requestedWith),r[contentType]||(r[contentType]=e.contentType||defaultHeaders.contentType);for(n in r)r.hasOwnProperty(n)&&"setRequestHeader"in t&&t.setRequestHeader(n,r[n])}function setCredentials(t,e){"undefined"!=typeof e.withCredentials&&"undefined"!=typeof t.withCredentials&&(t.withCredentials=!!e.withCredentials)}function generalCallback(t){lastValue=t}function urlappend(t,e){return t+(/\?/.test(t)?"&":"?")+e}function handleJsonp(t,e,n,r){var i=uniqid++,o=t.jsonpCallback||"callback",s=t.jsonpCallbackName||reqwest.getcallbackPrefix(i),a=new RegExp("((^|\\?|&)"+o+")=([^&]+)"),u=r.match(a),c=doc.createElement("script"),l=0,f=-1!==navigator.userAgent.indexOf("MSIE 10.0");return u?"?"===u[3]?r=r.replace(a,"$1="+s):s=u[3]:r=urlappend(r,o+"="+s),win[s]=generalCallback,c.type="text/javascript",c.src=r,c.async=!0,"undefined"==typeof c.onreadystatechange||f||(c.htmlFor=c.id="_reqwest_"+i),c.onload=c.onreadystatechange=function(){return c[readyState]&&"complete"!==c[readyState]&&"loaded"!==c[readyState]||l?!1:(c.onload=c.onreadystatechange=null,c.onclick&&c.onclick(),e(lastValue),lastValue=void 0,head.removeChild(c),l=1,void 0)},head.appendChild(c),{abort:function(){c.onload=c.onreadystatechange=null,n({},"Request is aborted: timeout",{}),lastValue=void 0,head.removeChild(c),l=1}}}function getRequest(t,e){var n,r=this.o,i=(r.method||"GET").toUpperCase(),o="string"==typeof r?r:r.url,s=r.processData!==!1&&r.data&&"string"!=typeof r.data?reqwest.toQueryString(r.data):r.data||null,a=!1;return"jsonp"!=r.type&&"GET"!=i||!s||(o=urlappend(o,s),s=null),"jsonp"==r.type?handleJsonp(r,t,e,o):(n=r.xhr&&r.xhr(r)||xhr(r),n.open(i,o,r.async===!1?!1:!0),setHeaders(n,r),setCredentials(n,r),win[xDomainRequest]&&n instanceof win[xDomainRequest]?(n.onload=t,n.onerror=e,n.onprogress=function(){},a=!0):n.onreadystatechange=handleReadyState(this,t,e),r.before&&r.before(n),a?setTimeout(function(){n.send(s)},200):n.send(s),n)}function Reqwest(t,e){this.o=t,this.fn=e,init.apply(this,arguments)}function setType(t){return t.match("json")?"json":t.match("javascript")?"js":t.match("text")?"html":t.match("xml")?"xml":void 0}function init(o,fn){function complete(t){for(o.timeout&&clearTimeout(self.timeout),self.timeout=null;self._completeHandlers.length>0;)self._completeHandlers.shift()(t)}function success(resp){var type=o.type||setType(resp.getResponseHeader("Content-Type"));resp="jsonp"!==type?self.request:resp;var filteredResponse=globalSetupOptions.dataFilter(resp.responseText,type),r=filteredResponse;try{resp.responseText=r}catch(e){}if(r)switch(type){case"json":try{resp=win.JSON?win.JSON.parse(r):eval("("+r+")")}catch(err){return error(resp,"Could not parse JSON in response",err)}break;case"js":resp=eval(r);break;case"html":resp=r;break;case"xml":resp=resp.responseXML&&resp.responseXML.parseError&&resp.responseXML.parseError.errorCode&&resp.responseXML.parseError.reason?null:resp.responseXML}for(self._responseArgs.resp=resp,self._fulfilled=!0,fn(resp),self._successHandler(resp);self._fulfillmentHandlers.length>0;)resp=self._fulfillmentHandlers.shift()(resp);complete(resp)}function error(t,e,n){for(t=self.request,self._responseArgs.resp=t,self._responseArgs.msg=e,self._responseArgs.t=n,self._erred=!0;self._errorHandlers.length>0;)self._errorHandlers.shift()(t,e,n);complete(t)}this.url="string"==typeof o?o:o.url,this.timeout=null,this._fulfilled=!1,this._successHandler=function(){},this._fulfillmentHandlers=[],this._errorHandlers=[],this._completeHandlers=[],this._erred=!1,this._responseArgs={};var self=this;fn=fn||function(){},o.timeout&&(this.timeout=setTimeout(function(){self.abort()},o.timeout)),o.success&&(this._successHandler=function(){o.success.apply(o,arguments)}),o.error&&this._errorHandlers.push(function(){o.error.apply(o,arguments)}),o.complete&&this._completeHandlers.push(function(){o.complete.apply(o,arguments)}),this.request=getRequest.call(this,success,error)}function reqwest(t,e){return new Reqwest(t,e)}function normalize(t){return t?t.replace(/\r?\n/g,"\r\n"):""}function serial(t,e){var n,r,i,o,s=t.name,a=t.tagName.toLowerCase(),u=function(t){t&&!t.disabled&&e(s,normalize(t.attributes.value&&t.attributes.value.specified?t.value:t.text))};if(!t.disabled&&s)switch(a){case"input":/reset|button|image|file/i.test(t.type)||(n=/checkbox/i.test(t.type),r=/radio/i.test(t.type),i=t.value,(!(n||r)||t.checked)&&e(s,normalize(n&&""===i?"on":i)));break;case"textarea":e(s,normalize(t.value));break;case"select":if("select-one"===t.type.toLowerCase())u(t.selectedIndex>=0?t.options[t.selectedIndex]:null);else for(o=0;t.length&&o<t.length;o++)t.options[o].selected&&u(t.options[o])}}function eachFormElement(){var t,e,n=this,r=function(t,e){var r,i,o;for(r=0;r<e.length;r++)for(o=t[byTag](e[r]),i=0;i<o.length;i++)serial(o[i],n)};for(e=0;e<arguments.length;e++)t=arguments[e],/input|select|textarea/i.test(t.tagName)&&serial(t,n),r(t,["input","select","textarea"])}function serializeQueryString(){return reqwest.toQueryString(reqwest.serializeArray.apply(null,arguments))}function serializeHash(){var t={};return eachFormElement.apply(function(e,n){e in t?(t[e]&&!isArray(t[e])&&(t[e]=[t[e]]),t[e].push(n)):t[e]=n},arguments),t}function buildParams(t,e,n,r){var i,o,s,a=/\[\]$/;if(isArray(e))for(o=0;e&&o<e.length;o++)s=e[o],n||a.test(t)?r(t,s):buildParams(t+"["+("object"==typeof s?o:"")+"]",s,n,r);else if(e&&"[object Object]"===e.toString())for(i in e)buildParams(t+"["+i+"]",e[i],n,r);else r(t,e)}var win=window,doc=document,twoHundo=/^(20\d|1223)$/,byTag="getElementsByTagName",readyState="readyState",contentType="Content-Type",requestedWith="X-Requested-With",head=doc[byTag]("head")[0],uniqid=0,callbackPrefix="reqwest_"+ +new Date,lastValue,xmlHttpRequest="XMLHttpRequest",xDomainRequest="XDomainRequest",noop=function(){},isArray="function"==typeof Array.isArray?Array.isArray:function(t){return t instanceof Array},defaultHeaders={contentType:"application/x-www-form-urlencoded",requestedWith:xmlHttpRequest,accept:{"*":"text/javascript, text/html, application/xml, text/xml, */*",xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript",js:"application/javascript, text/javascript"}},xhr=function(t){if(t.crossOrigin===!0){var e=win[xmlHttpRequest]?new XMLHttpRequest:null;if(e&&"withCredentials"in e)return e;if(win[xDomainRequest])return new XDomainRequest;throw new Error("Browser does not support cross-origin requests")}return win[xmlHttpRequest]?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")},globalSetupOptions={dataFilter:function(t){return t}};return Reqwest.prototype={abort:function(){this._aborted=!0,this.request.abort()},retry:function(){init.call(this,this.o,this.fn)},then:function(t,e){return t=t||function(){},e=e||function(){},this._fulfilled?this._responseArgs.resp=t(this._responseArgs.resp):this._erred?e(this._responseArgs.resp,this._responseArgs.msg,this._responseArgs.t):(this._fulfillmentHandlers.push(t),this._errorHandlers.push(e)),this},always:function(t){return this._fulfilled||this._erred?t(this._responseArgs.resp):this._completeHandlers.push(t),this},fail:function(t){return this._erred?t(this._responseArgs.resp,this._responseArgs.msg,this._responseArgs.t):this._errorHandlers.push(t),this}},reqwest.serializeArray=function(){var t=[];return eachFormElement.apply(function(e,n){t.push({name:e,value:n})},arguments),t},reqwest.serialize=function(){if(0===arguments.length)return"";var t,e,n=Array.prototype.slice.call(arguments,0);return t=n.pop(),t&&t.nodeType&&n.push(t)&&(t=null),t&&(t=t.type),e="map"==t?serializeHash:"array"==t?reqwest.serializeArray:serializeQueryString,e.apply(null,n)},reqwest.toQueryString=function(t,e){var n,r,i=e||!1,o=[],s=encodeURIComponent,a=function(t,e){e="function"==typeof e?e():null==e?"":e,o[o.length]=s(t)+"="+s(e)};if(isArray(t))for(r=0;t&&r<t.length;r++)a(t[r].name,t[r].value);else for(n in t)t.hasOwnProperty(n)&&buildParams(n,t[n],i,a);return o.join("&").replace(/%20/g,"+")},reqwest.getcallbackPrefix=function(){return callbackPrefix},reqwest.compat=function(t,e){return t&&(t.type&&(t.method=t.type)&&delete t.type,t.dataType&&(t.type=t.dataType),t.jsonpCallback&&(t.jsonpCallbackName=t.jsonpCallback)&&delete t.jsonpCallback,t.jsonp&&(t.jsonpCallback=t.jsonp)),new Reqwest(t,e)},reqwest.ajaxSetup=function(t){t=t||{};for(var e in t)globalSetupOptions[e]=t[e]},reqwest}),function(){var t,e=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};window.InfluxDB=t=function(){function t(t){var n;t||(t={}),this.host=t.host||"localhost",this.hosts=t.hosts||[this.host],this.port=t.port||8086,this.username=t.username||"root",this.password=t.password||"root",this.database=t.database,this.ssl=t.ssl||!1,this.max_retries=t.max_retries||20,this.isCrossOrigin=(n=window.location.host,e.call(this.hosts,n)<0),this.username=encodeURIComponent(this.username),this.password=encodeURIComponent(this.password)}return t.prototype.getDatabases=function(){return this.get(this.path("db"))},t.prototype.createDatabase=function(t,e){var n;return n={name:t},this.post(this.path("db"),n,e)},t.prototype.deleteDatabase=function(t){return this["delete"](this.path("db/"+t))},t.prototype.getClusterConfiguration=function(){return this.get(this.path("cluster/configuration"))},t.prototype.createDatabaseConfig=function(t,e,n){return this.post(this.path("cluster/database_configs/"+t),e,n)},t.prototype.getDatabaseUsers=function(t){return this.get(this.path("db/"+t+"/users"))},t.prototype.createUser=function(t,e,n,r){var i;return i={name:e,password:n},this.post(this.path("db/"+t+"/users"),i,r)},t.prototype.deleteDatabaseUser=function(t,e){return this["delete"](this.path("db/"+t+"/users/"+e))},t.prototype.getDatabaseUser=function(t,e){return this.get(this.path("db/"+t+"/users/"+e))},t.prototype.updateDatabaseUser=function(t,e,n,r){return this.post(this.path("db/"+t+"/users/"+e),n,r)},t.prototype.authenticateDatabaseUser=function(){return this.get(this.path("db/"+this.database+"/authenticate"))},t.prototype.getClusterAdmins=function(){return this.get(this.path("cluster_admins"))},t.prototype.deleteClusterAdmin=function(t){return this["delete"](this.path("cluster_admins/"+t))},t.prototype.createClusterAdmin=function(t,e){var n;return n={name:t,password:e},this.post(this.path("cluster_admins"),n)},t.prototype.updateClusterAdmin=function(t,e,n){return this.post(this.path("cluster_admins/"+t),e,n)},t.prototype.authenticateClusterAdmin=function(){return this.get(this.path("cluster_admins/authenticate"))},t.prototype.getContinuousQueries=function(t){return this.get(this.path("db/"+t+"/continuous_queries"))},t.prototype.deleteContinuousQuery=function(t,e){return this["delete"](this.path("db/"+t+"/continuous_queries/"+e))},t.prototype.getClusterServers=function(){return this.get(this.path("cluster/servers"))},t.prototype.getClusterShardSpaces=function(){return this.get(this.path("cluster/shard_spaces"))},t.prototype.getClusterShards=function(){return this.get(this.path("cluster/shards"))},t.prototype.createClusterShard=function(t,e,n,r,i,o){var s;return s={database:n,spaceName:r,startTime:t,endTime:e,longTerm:longTerm,shards:[{serverIds:i}]},this.post(this.path("cluster/shards"),s,o)},t.prototype.deleteClusterShard=function(t,e){var n;return n={serverIds:e},this["delete"](this.path("cluster/shards/"+t),n)},t.prototype.getInterfaces=function(){return this.get(this.path("interfaces"))},t.prototype.readPoint=function(t,e,n){var r;return r="SELECT "+t+" FROM "+e+";",this.get(this.path("db/"+this.database+"/series",{q:r}),n)},t.prototype._readPoint=function(t,e){return this.get(this.path("db/"+this.database+"/series",{q:t}),e)},t.prototype.query=function(t,e){return this.get(this.path("db/"+this.database+"/series",{q:t}),e)},t.prototype.get=function(t,e){var n=this;return new Promise(function(r,i){return n.retry(r,i,function(){return reqwest({method:"get",type:"json",url:n.url(t),crossOrigin:n.isCrossOrigin,success:function(t){return r(t),e?e(n.formatPoints(t)):void 0}})})})},t.prototype.post=function(t,e){var n=this;return new Promise(function(r,i){return n.retry(r,i,function(){return reqwest({method:"post",type:"json",url:n.url(t),crossOrigin:n.isCrossOrigin,contentType:"application/json",data:JSON.stringify(e),success:function(t){return r(t)}})})})},t.prototype["delete"]=function(t,e){var n=this;return new Promise(function(r,i){return n.retry(r,i,function(){return reqwest({method:"delete",type:"json",url:n.url(t),crossOrigin:n.isCrossOrigin,data:JSON.stringify(e),success:function(t){return r(t),"undefined"!=typeof callback&&null!==callback?callback(t):void 0}})})})},t.prototype.formatPoints=function(t){return t.map(function(t){var e;return e={name:t.name,points:t.points.map(function(e){var n,r;return n={},t.columns.forEach(function(t,r){return n[t]=e[r]}),r=new Date(0),r.setUTCSeconds(Math.round(n.time/1e3)),n.time=r,n})}})},t.prototype.writePoint=function(t,e,n,r){var i,o,s,a,u;null==n&&(n={}),o={points:[],name:t,columns:[]},a=[];for(s in e)u=e[s],a.push(u),o.columns.push(s);return o.points.push(a),i=[o],this.post(this.path("db/"+this.database+"/series"),i,r)},t.prototype.writeSeries=function(t,e){return this.post(this.path("db/"+this.database+"/series"),t,e)},t.prototype.path=function(t,e){var n;return n=""+t+"?u="+this.username+"&p="+this.password,null!=e&&e.q&&(n+="&q="+encodeURIComponent(e.q)),n},t.prototype.url=function(t){var e;return e=this.hosts.shift(),this.hosts.push(e),""+(this.ssl?"https":"http")+"://"+e+":"+this.port+"/"+t},t.prototype.retry=function(t,e,n,r,i){var o=this;return null==r&&(r=10),null==i&&(i=this.max_retries),n().then(void 0,function(s){return 0===s.status?setTimeout(function(){return o.retry(t,e,n,Math.min(2*r,3e4),i-1)},r):e(s)})},t}()}.call(this),window.InfluxDB.VERSION="0.0.16",function(){}.call(this);